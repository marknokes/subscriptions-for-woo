var ppsfwooSubscribeButton=document.getElementById("subscribeButton"),ppsfwooEllipsis=document.getElementById("lds-ellipsis"),ppsfwooShortcodeContainer=document.getElementById("ppsfwoo-shortcode-button-container");function ppsfwooCreateQuantityInput(){var e=document.createElement("input"),t=(e.type="number",e.id="quantityInput",e.name="quantity",e.min="1",e.value="1",document.createElement("label")),o=(t.setAttribute("for","quantityInput"),t.innerHTML="Quantity: ",document.getElementById("quantityInputContainer"));o.appendChild(t),o.appendChild(e)}function ppsfwooSendPostRequest(a,p){return new Promise((t,o)=>{var e,n=new XMLHttpRequest,r=(n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE)if(200===n.status)try{var e=JSON.parse(n.responseText);t(e)}catch(e){o(new Error("Invalid JSON response"))}else o(new Error("Request failed: "+n.status))},n.onerror=function(){o(new Error("Network error occurred"))},new URLSearchParams);for(e in p)r.append(e,p[e]);n.open("POST",a,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(r.toString())})}function ppsfwooLoadPayPalScript(e,t,o,n,r){var a;window.paypal?r(t,o):((a=document.createElement("script")).setAttribute("src",`https://www.paypal.com/sdk/js?client-id=${e}&vault=true&intent=subscription`),a.setAttribute("data-sdk-integration-source","button-factory"),a.onload=function(){r(t,o)},a.onerror=function(){var e="Failed to load PayPal sdk";console.log(e),ppsfwooLogButtonError(e),alert("There has been an unexpeced error. Please refresh and try again."),location.reload()},n&&ppsfwooCreateQuantityInput(),document.body.appendChild(a))}function ppsfwooLogButtonError(e){ppsfwooSendPostRequest("/wp-admin/admin-ajax.php",{action:"ppsfwoo_admin_ajax_callback",method:"log_paypal_buttons_error",message:e}).then(e=>{console.log(e)}).catch(e=>{console.log(e)})}function ppsfwooRender(o,n){ppsfwooEllipsis&&ppsfwooEllipsis.style.setProperty("display","none","important");var e=document.createElement("div");e.setAttribute("id","paypal-button-container-"+n),ppsfwooSubscribeButton?ppsfwooSubscribeButton.insertAdjacentElement("afterend",e):ppsfwooShortcodeContainer?ppsfwooShortcodeContainer.replaceWith(e):alert("Unable to render PayPal button"),paypal.Buttons({style:{shape:"rect",layout:"vertical",color:"gold",label:"subscribe"},createSubscription:function(e,t){var o=document.getElementById("quantityInput"),e={plan_id:n};return o&&(e.quantity=o.value),t.subscription.create(e)},onApprove:function(e,t){e=ppsfwoo_paypal_ajax_var.redirect+"?subs_id="+e.subscriptionID+"&subs_id_redirect_nonce="+o;window.location.assign(e)},onError:function(e){e.message&&ppsfwooLogButtonError(e.message)}}).render("#paypal-button-container-"+n)}function ppsfwooInitializePayPalSubscription(){ppsfwooSendPostRequest("/wp-admin/admin-ajax.php",{action:"ppsfwoo_admin_ajax_callback",method:"subs_id_redirect_nonce",product_id:ppsfwoo_paypal_ajax_var.product_id}).then(e=>{if(e.error)throw new Error("No plan id found for product with ID "+ppsfwoo_paypal_ajax_var.product_id);ppsfwooLoadPayPalScript(e.client_id,e.nonce,e.plan_id,e.quantity_supported,ppsfwooRender)}).catch(e=>{console.log(e),ppsfwooLogButtonError(e),alert("There has been an unexpeced error. Please refresh and try again."),location.reload()})}ppsfwooSubscribeButton&&ppsfwooSubscribeButton.addEventListener("click",function(){this.style.display="none",ppsfwooEllipsis.style.setProperty("display","inline-block","important"),ppsfwooInitializePayPalSubscription()});