function ppsfwooSendPostRequest(s,r){return new Promise((t,o)=>{var e,n=new XMLHttpRequest,a=(n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE)if(200===n.status)try{var e=JSON.parse(n.responseText);t(e)}catch(e){o(new Error("Invalid JSON response"))}else o(new Error("Request failed: "+n.status))},n.onerror=function(){o(new Error("Network error occurred"))},new URLSearchParams);for(e in r)a.append(e,r[e]);n.open("POST",s,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(a.toString())})}function ppsfwooLoadPayPalScript(e){var t;window.paypal?e():((t=document.createElement("script")).setAttribute("src",`https://www.paypal.com/sdk/js?client-id=${ppsfwoo_paypal_ajax_var.client_id}&vault=true&intent=subscription`),t.setAttribute("data-sdk-integration-source","button-factory"),t.setAttribute("async",!0),t.onload=e,document.body.appendChild(t))}function ppsfwooRender(o){document.getElementById("lds-ellipsis").style.setProperty("display","none","important"),paypal.Buttons({style:{shape:"rect",layout:"vertical",color:"gold",label:"subscribe"},createSubscription:function(e,t){return t.subscription.create({plan_id:ppsfwoo_paypal_ajax_var.plan_id})},onApprove:function(e,t){e=ppsfwoo_paypal_ajax_var.redirect+"?subs_id="+e.subscriptionID+"&subs_id_redirect_nonce="+o;window.location.assign(e)},onError:function(e){e.message&&ppsfwooSendPostRequest("/wp-admin/admin-ajax.php",{action:"ppsfwoo_admin_ajax_callback",method:"log_paypal_buttons_error",message:e.message}).then(e=>{console.log(e)}).catch(e=>{console.log(e)})}}).render("#paypal-button-container-"+ppsfwoo_paypal_ajax_var.plan_id)}function ppsfwooInitializePayPalSubscription(){ppsfwooSendPostRequest("/wp-admin/admin-ajax.php",{action:"ppsfwoo_admin_ajax_callback",method:"subs_id_redirect_nonce"}).then(e=>{ppsfwooRender(e.nonce)}).catch(e=>{console.log(e),alert("There has been an unexpeced error. Please refresh and try again.")})}document.getElementById("subscribeButton").addEventListener("click",function(){this.style.display="none",document.getElementById("lds-ellipsis").style.setProperty("display","inline-block","important"),ppsfwooLoadPayPalScript(ppsfwooInitializePayPalSubscription)});
