function ppsfwooGetQuantityInputId(e){return"ppsfwoo-quantity-input-"+e}function ppsfwooCreateQuantityInput(e){var t=document.getElementById("ppsfwoo-quantity-input-container-"+e),n=document.createElement("input"),o=document.createElement("label"),e=ppsfwooGetQuantityInputId(e);n.type="number",n.id=e,n.classList.add("ppsfwoo-quantity-input"),n.name="quantity",n.min="1",n.value="1",o.setAttribute("for",e),o.innerHTML="Quantity: ",t?t.appendChild(o).appendChild(n):alert("Unable to render PayPal button")}function ppsfwooSendPostRequest(a,p){return new Promise((t,n)=>{var e,o=new XMLHttpRequest,r=(o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE)if(200===o.status)try{var e=JSON.parse(o.responseText);t(e)}catch(e){n(new Error("Invalid JSON response"))}else n(new Error("Request failed: "+o.status))},o.onerror=function(){n(new Error("Network error occurred"))},new URLSearchParams);for(e in p)r.append(e,p[e]);o.open("POST",a,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(r.toString())})}function ppsfwooLogButtonError(e){ppsfwooSendPostRequest("/wp-admin/admin-ajax.php",{action:"ppsfwoo_admin_ajax_callback",method:"log_paypal_buttons_error",message:e}).then(e=>{console.log(e)}).catch(e=>{console.log(e)})}function ppsfwooCreateBtnContainer(o,e,r){return new Promise((e,t)=>{var n=document.createElement("div");n.setAttribute("id","paypal-button-container-"+o),r?r.insertAdjacentElement("afterend",n):alert("Unable to render PayPal button"),requestAnimationFrame(()=>e(n))})}function ppsfwooRender(n,r,a,e){ppsfwooCreateBtnContainer(r,a,e).then(e=>{paypal.Buttons({style:{shape:"rect",layout:"vertical",color:"gold",label:"subscribe"},createSubscription:function(e,t){var n=document.getElementById(ppsfwooGetQuantityInputId(a)),o={plan_id:r};return n&&(o.quantity=n.value),t.subscription.create(o)},onApprove:function(e,t){e=ppsfwoo_paypal_ajax_var.redirect+"?subs_id="+e.subscriptionID+"&subs_id_redirect_nonce="+n;window.location.assign(e)},onError:function(e){e.message&&ppsfwooLogButtonError(e.message)}}).render("#"+e.id)})}function ppsfwooInitializePayPalSubscription(t,n){ppsfwooSendPostRequest("/wp-admin/admin-ajax.php",{action:"ppsfwoo_admin_ajax_callback",method:"subs_id_redirect_nonce",product_id:t}).then(async e=>{if(e.error)throw new Error("No plan id found for product with ID "+t);document.getElementById("lds-ellipsis-"+t).style.setProperty("display","none"),e.quantity_supported&&ppsfwooCreateQuantityInput(t),ppsfwooRender(e.nonce,e.plan_id,t,n)}).catch(e=>{console.log(e),ppsfwooLogButtonError(e),alert("There has been an unexpeced error. Please refresh and try again.")})}