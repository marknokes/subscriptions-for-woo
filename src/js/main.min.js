jQuery(document).ready(function(s){var a,e="There has been an error. Please try again and check your <a href='"+ppsfwoo_ajax_var.settings_url+"'>WooCommerce PayPal Payments settings</a>.";function n(t="",e="success"){s("#wpcontent").prepend(`<div style="z-index: 9999; position: fixed; width: 82%" class="notice notice-${e} is-dismissible single-cached"><p>${t}</p><button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button></div>`),setTimeout(function(){s(".notice-dismiss").parent().fadeOut("slow",function(){s(this).remove()})},5e3),s(".notice-dismiss").click(function(t){s(this).parent().remove()})}function r(t,e,a={}){t={action:"ppsfwoo_admin_ajax_callback",method:t};s.isEmptyObject(a)||(t=s.extend({},t,a)),s.ajax({type:"POST",url:"/wp-admin/admin-ajax.php",data:t,success:e})}function l(){r("list_plans",function(t){var i=!!t&&JSON.parse(t),t=!1!==i?Object.keys(i):[],e=s("#plans"),o="";0!==t.length&&"000"!==t[0]&&(t.forEach(t=>{var e=Object.values(i[t]),a="ACTIVE"===e[3],s="",n="";"000"!==t&&(s=a?`<a href="#" class="deactivate" data-plan-id="${t}">Deactivate</a>`:`<a href="#" class="activate" data-plan-id="${t}">Activate</a>`,n=a?`<span class="tooltip status green"><span class="tooltip-text">${e[3]}</span></span>`:`<span class="tooltip status red"><span class="tooltip-text">${e[3]}</span></span>`),o+=`<tr class="plan-row"><td>${t}</td><td>${e[0]}</td><td>${e[1]}</td><td>${e[2]}</td><td><p class="copy-text" style="position: absolute; left: -9999px;">${ppsfwoo_ajax_var.paypal_url}/webapps/billing/plans/subscribe?plan_id=${t}</p><button class="copy-button">Copy to clipboard</button></td><td>${n}</td><td>${s}</td></tr>`}),e.find(".plan-row").remove(),e.append(o),e.show(),r("list_webhooks",function(t){var e,a;t&&(t=JSON.parse(t),e=s("#webhooks"),a="",Object.values(t).forEach(t=>{a+=`<tr class="webhook-row"><td>${t.name}</td><td>${t.description}</td></tr>`}),e.find(".webhook-row").remove(),e.append(a),e.show())}),s("a.deactivate, a.activate").click(function(t){t.preventDefault(),c("Processing..."),r("modify_plan",function(t){t=JSON.parse(t);(t.error?(alert(t.error),p):l)()},{plan_id:s(this).data("plan-id"),paypal_action:s(this).attr("class")})}),s(".plan-row").on("click",".copy-button",function(t){var e=s(this).prev(".copy-text"),a=s("<textarea>");a.val(e.text()),s("body").append(a),a.select(),a[0].setSelectionRange(0,99999),document.execCommand("copy"),a.remove(),alert("Copied to clipboard: "+e.text()),t.preventDefault()}),p())})}function c(t){var e=document.createElement("div"),a=(e.setAttribute("role","overlay"),e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(0, 0, 0, 0.5)",e.style.zIndex="1000",document.createElement("div"));a.style.position="absolute",a.style.top="50%",a.style.left="50%",a.style.transform="translate(-50%, -50%)",a.style.backgroundColor="white",a.style.padding="20px",a.style.borderRadius="5px",a.style.boxShadow="0 0 10px rgba(0, 0, 0, 0.3)",a.textContent=t||"Please wait...",e.appendChild(a),document.body.appendChild(e)}function p(){var t=document.querySelector('div[role="overlay"]');t&&t.parentNode.removeChild(t)}l(),s("#subs-search").on("submit",function(t){t.preventDefault();t=s("#email-input").val();t&&r("search_subscribers",function(t){"false"!==t?(s("#tab-subscribers .pagination, .button.export-table-data").hide(),s("#reset").show(),s("#subscribers").replaceWith(t)):n("No users found with that email address.","warning")},{email:t})}),s("#refresh").click(function(t){t.preventDefault(),c("Processing..."),r("refresh_plans",function(t){t=JSON.parse(t);0===t.plans.length?n("No plans found.","warning"):t.success?(n("Successfully refreshed plans."),l()):n(e,"error"),p()})}),s(".nav-tab-wrapper a").click(function(t){t.preventDefault(),s(".nav-tab").removeClass("nav-tab-active"),s(this).addClass("nav-tab-active"),s(".tab-content").hide(),a=s(this).attr("href"),s("#"+a).fadeIn()}),(s(".nav-tab-wrapper a").hasClass("nav-tab-active")?s(".nav-tab-wrapper a.nav-tab-active"):s(".nav-tab-wrapper a:first-child")).click(),s("#ppsfwoo_options").submit(function(t){var e=function(t){var e=t.split("?");{var a;if(2<=e.length)return a=e[1].split("&").filter(function(t){return!t.startsWith("subs_page_num=")&&!t.startsWith("var2=")}),e[0]+"?"+a.join("&")}return t}(($element=s(this).find("input[name=_wp_http_referer]")).attr("value"));$element.attr("value",e+"&tab="+a)}),s("input[name=ppsfwoo_delete_plugin_data]").click(function(t){if(s(this).is(":checked"))return confirm("Selecting this option will delete plugin options and the subscribers table on plugin deactivation. Are you sure you want to do this?\n\nThe setting will take effect after you 'Save Changes' below.")})});
